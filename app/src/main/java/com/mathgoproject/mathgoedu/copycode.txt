package com.bsoftwarefoundation.mathgo;

import androidx.appcompat.app.AppCompatActivity;

import android.content.Intent;
import android.os.Bundle;
import android.util.Log;
import android.view.Window;
import android.view.WindowManager;
import android.widget.ImageView;
import android.widget.RadioButton;
import android.widget.RadioGroup;
import android.widget.TextView;

import java.util.List;
import java.util.Random;

public class Maingameactivity extends AppCompatActivity {

    private ImageView imagesoal;
    private TextView soaltext;
    private RadioButton opsia,opsib,opsic,opsid;
    private List<Setgetquestion> questionlist;
    private Setgetquestion setgetquestion;
    int quiz = 0;
    private int score = 0;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,WindowManager.LayoutParams.FLAG_FULLSCREEN);
        setContentView(R.layout.activity_maingameactivity);

        // TODO: get all question from database
        Quizdatabase quizDataBase = new Quizdatabase(this);
        questionlist = quizDataBase.getAllQuestion(); // get from database
        Log.d("pertanyaan",questionlist.toString());
        setgetquestion = questionlist.get(quiz);

        imagesoal = findViewById(R.id.gambar_quiz);
        soaltext = findViewById(R.id.soal);
        opsia = findViewById(R.id.opsiA);
        opsib = findViewById(R.id.opsiB);
        opsic = findViewById(R.id.opsiC);
        opsid = findViewById(R.id.opsiD);
        setquestion();
    }

    private void setquestion(){
        imagesoal.setImageResource(setgetquestion.getImageLoad());
        soaltext.setText(setgetquestion.getQuestion());
        opsia.setText(setgetquestion.getOpsiA());
        opsib.setText(setgetquestion.getOpsiB());
        opsic.setText(setgetquestion.getOpsiC());
        opsid.setText(setgetquestion.getOpsiD());
        quiz++;
    }

    public void buttonclick(){
        RadioGroup radioGroup = findViewById(R.id.radiogrup);
        RadioButton radioButtonAnswer = findViewById(radioGroup.getCheckedRadioButtonId());

        // TODO: I'm gonna make some a logic if answer is correct a score 5, if wrong a value is not 0 but random value

        if(setgetquestion.getAnswer().equals(radioButtonAnswer.getText())){
            score = 5;
        } else {
            // this generate a value
            try {
                int[] value = {1, 2, 3, 4};
                int valuegenerator = value[new Random().nextInt(value.length)];
                score = valuegenerator;
                Intent intent = new Intent(); // TODO : Intent in scoreactivity and save a value in sharepreference
                startActivity(intent);
                finish();
            } catch (IndexOutOfBoundsException indexoutofbound){
                // TODO: catch indexoutofbound exception in here !
            }
        }

        if (quiz < 6){ // Total Question 6 (for Beta)
            setgetquestion = questionlist.get(quiz);
            setquestion();
        } // TODO : Input data after quiz increment == 6
    }

}




// activity (daynight layout)



 <androidx.cardview.widget.CardView
                android:id="@+id/card_UIset"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_below="@id/Settings_Text"
                android:layout_marginTop="20dp"
                app:cardUseCompatPadding="true"
                app:cardCornerRadius="10dp"
                app:cardElevation="3dp">

                <RelativeLayout
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_margin="5dp">

                    <TextView
                        android:id="@+id/Title_set"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_marginStart="5dp"
                        android:text="Tampilan"
                        android:textSize="20sp"
                        android:textStyle="bold"
                        android:textColor="@android:color/background_dark"/>

                    <TextView
                        android:id="@+id/opsion_text"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_below="@+id/Title_set"
                        android:layout_marginStart="10dp"
                        android:layout_marginTop="10dp"
                        android:text="Ubah ke tema gelap"
                        android:textSize="15sp"
                        android:textStyle="bold"
                        android:textColor="@android:color/black"/>


                    <Switch
                        android:id="@+id/background_changer"
                        android:layout_width="340dp"
                        android:layout_height="wrap_content"
                        android:layout_alignParentEnd="true"
                        android:layout_marginTop="35dp"
                        android:checked="false"
                        tools:ignore="TouchTargetSizeCheck" />

                </RelativeLayout>
            </androidx.cardview.widget.CardView>


    background_switch = findViewById(R.id.background_changer);

    background_switch.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
                @Override
                public void onCheckedChanged(CompoundButton buttonView, final boolean isChecked) {
                    final AlertDialog.Builder builder = new AlertDialog.Builder(Settingactivity.this);
                    builder.setTitle("Peringatan");
                    builder.setMessage("Apabila menganti tema maka aplikasi direstart ");
                    builder.setCancelable(false); // back key doesn't close a dialog box
                    builder.setPositiveButton(
                            "Ya", new DialogInterface.OnClickListener() {
                                @Override
                                public void onClick(DialogInterface dialog, int which) {
                                    settheme(isChecked);
                                    background_switch.setChecked(true);
                                    Intent intent = new Intent(Settingactivity.this,Startactivity.class);
                                    startActivity(intent);
                                    finish();
                                }
                            });
                    builder.setNegativeButton(
                            "Tidak", new DialogInterface.OnClickListener() {
                                @Override
                                public void onClick(DialogInterface dialog, int which) {
                                    dialog.cancel();
                                }
                            });
                    AlertDialog alertDialog = builder.create();
                    alertDialog.show();
                }
            });




 // TODO: Memory tester Message

 2021-09-20 20:25:23.986 6068-6068/com.bsoftwarefoundation.mathgo V/Oncreate: MaxMem :134217728
 2021-09-20 20:25:23.986 6068-6068/com.bsoftwarefoundation.mathgo V/Oncreate: FreMem :577044
 2021-09-20 20:25:23.987 6068-6068/com.bsoftwarefoundation.mathgo V/Oncreate: Memory class :128